
use learn;

drop table goods;
create table goods (
                       `id`  BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT  COMMENT 'ID',
                       `cid` int(11) unsigned not null default 0,
                       `title` varchar(100),
                       `tags` json,
                       PRIMARY KEY (`id`)
) ENGINE = InnoDB DEFAULT CHARACTER SET = utf8mb4 COMMENT = 'article';

insert into goods(title, cid, tags) values
('article 1' , 1, '["123","112", "133"]'),
('article 2' , 1, '["123","112", "133"]'),
('article 3' , 1, '["123","112", "133"]'),
('article 4' , 1, '["123","112", "133"]'),

('article 5' , 2, '["123","456", "133"]'),
('article 6' , 2, '["123","456", "789"]'),
('article 7' , 2, '["123","456", "999"]'),

('article 100' , 3, '["123","112","133"]')
;

alter table goods add index tag( cid,  ( cast(tags->'$' as char array))  );


explain
select * from goods where cid=3 and   '133' member of (tags->'$');

explain
select * from goods where JSON_CONTAINS(tags->'$', '123') ;

explain
select * from goods where cid=1 and JSON_CONTAINS(tags->'$', '123') ;

explain
select * from goods where cid=1 and '123' member of (tags);

explain
select * from goods where cid=1;


use wolf_setting;
INSERT INTO `company_setting` VALUES
                                     (17,1,'defNS','{\"address\":\"HangZhou\",\"name\":\"org 1\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\",\"age\":10}',0,0,0,'2020-04-20 15:50:10','2020-04-22 18:26:34'),
                                     (18,1,'info','{\"address\":\"HangZhou\",\"name\":\"test company name\",\"age\":10}',0,0,0,'2020-04-20 15:52:02',NULL),
                                     (31,2,'defNS','{\"name\":\"org 2\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 18:26:47','2020-04-22 18:26:47'),
                                     (32,3,'defNS','{\"name\":\"org 3\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 18:26:55','2020-04-22 18:26:55'),
                                     (33,4,'defNS','{\"name\":\"org 4\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 18:28:27','2020-04-22 18:28:27'),
                                     (34,5,'defNS','{\"name\":\"org 5\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 18:28:53','2020-04-22 18:28:53'),
                                     (35,6,'defNS','{\"name\":\"org 6\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 18:30:20','2020-04-22 18:30:20'),
                                     (36,7,'defNS','{\"name\":\"org 7\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:45:08','2020-04-22 21:45:08'),
                                     (37,8,'defNS','{\"name\":\"org 8\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:45:19','2020-04-22 21:45:19'),
                                     (38,9,'defNS','{\"name\":\"org 9\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:45:29','2020-04-22 21:45:29'),
                                     (39,10,'defNS','{\"name\":\"org 10\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:45:38','2020-04-22 21:45:38'),
                                     (40,11,'defNS','{\"name\":\"org 11\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:45:47','2020-04-22 21:45:47'),
                                     (41,12,'defNS','{\"name\":\"org 12\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:06','2020-04-22 21:46:06'),
                                     (42,13,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:16','2020-04-22 21:46:16'),
                                     (43,14,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:21','2020-04-22 21:46:21'),
                                     (44,15,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:25','2020-04-22 21:46:25'),
                                     (45,16,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:31','2020-04-22 21:46:31'),
                                     (46,17,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:37','2020-04-22 21:46:37'),
                                     (47,18,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:43','2020-04-22 21:46:43'),
                                     (48,19,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:48','2020-04-22 21:46:48'),
                                     (49,20,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:54','2020-04-22 21:46:54'),
                                     (50,21,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:46:59','2020-04-22 21:46:59'),
                                     (51,22,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:04','2020-04-22 21:47:04'),
                                     (52,23,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:08','2020-04-22 21:47:08'),
                                     (53,24,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:16','2020-04-22 21:47:16'),
                                     (54,25,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:23','2020-04-22 21:47:23'),
                                     (55,26,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:32','2020-04-22 21:47:32'),
                                     (56,27,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:37','2020-04-22 21:47:37'),
                                     (57,28,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:42','2020-04-22 21:47:42'),
                                     (58,29,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:47','2020-04-22 21:47:47'),
                                     (59,30,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:47:53','2020-04-22 21:47:53'),
                                     (60,31,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:48:00','2020-04-22 21:48:00'),
                                     (61,32,'defNS','{\"name\":\"org xxx\",\"logo\":\"/img/20191213/870576fc-025b-6862-ca5d-aa2f2f72f88f.jpg\"}',0,0,0,'2020-04-22 21:48:08','2020-04-22 21:48:08');

