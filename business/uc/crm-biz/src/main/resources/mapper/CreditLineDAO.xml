<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="study.daydayup.wolf.business.uc.crm.biz.customer.credit.dal.dao.CreditLineDAO">


<!--auto generated by MybatisCodeHelper on 2020-03-10-->
    <select id="selectByAccountId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from credit_line
        where account_id=#{accountId,jdbcType=BIGINT}
        order by id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-03-10-->
    <select id="selectByOrgId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from credit_line
        where org_id=#{orgId,jdbcType=BIGINT}
        order by id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-03-10-->
    <select id="selectByAccountIdIn" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from credit_line
        where account_id in
        <foreach item="item" index="index" collection="accountIdCollection"
                 open="(" separator="," close=")">
            #{item,jdbcType=BIGINT}
        </foreach>
        and org_id=#{orgId,jdbcType=BIGINT}
        order by id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-03-10-->
    <select id="selectByAccountIdAndOrgId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from credit_line
        where account_id=#{accountId,jdbcType=BIGINT}
        and org_id=#{orgId,jdbcType=BIGINT}
        limit 1
    </select>

<!--auto generated by MybatisCodeHelper on 2020-03-10-->
    <update id="updateByAccountIdAndOrgId">
        update credit_line
        <set>
            <if test="updated.amount != null">
                amount = #{updated.amount,jdbcType=DECIMAL},
            </if>
            <if test="updated.currency != null">
                currency = #{updated.currency,jdbcType=INTEGER},
            </if>
            <if test="updated.timesLatestDay != null">
                times_latest_day = #{updated.timesLatestDay,jdbcType=INTEGER},
            </if>
            <if test="updated.timesLatestWeek != null">
                times_latest_week = #{updated.timesLatestWeek,jdbcType=INTEGER},
            </if>
            <if test="updated.timesLatestMonth != null">
                times_latest_month = #{updated.timesLatestMonth,jdbcType=INTEGER},
            </if>
            <if test="updated.timesLatestYear != null">
                times_latest_year = #{updated.timesLatestYear,jdbcType=INTEGER},
            </if>
            <if test="updated.promotedAt != null">
                promoted_at = #{updated.promotedAt,jdbcType=TIMESTAMP},
            </if>
            <if test="updated.deleteFlag != null">
                delete_flag = #{updated.deleteFlag,jdbcType=TINYINT},
            </if>
            <if test="updated.lastEditor != null">
                last_editor = #{updated.lastEditor,jdbcType=BIGINT},
            </if>

            <if test="updated.updatedAt != null">
                updated_at = #{updated.updatedAt,jdbcType=TIMESTAMP},
            </if>
            version = version + 1,
        </set>
        where account_id=#{accountId,jdbcType=BIGINT}
        and org_id=#{orgId,jdbcType=BIGINT}
        and version=#{version,jdbcType=INTEGER}
        limit 1
    </update>
</mapper>